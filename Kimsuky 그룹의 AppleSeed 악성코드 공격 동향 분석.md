# ****Kimsuky 그룹의 AppleSeed 악성코드 공격 동향 분석****

### 작성자

---

김순욱

### 개요

---

이번 주제는 북한의 지원을 받는다고 알려진 APT 그룹인 **Kimsuky 그룹**에서 사용하는 악성코드들에 대한 분석이다. 주로 스피어 피싱 공격을 통해 조직의 내부 정보 및 기술 탈취를 목적으로 국방, 방위산업, 언론, 외교, 국가기관, 학술 분야를 공격 중이다.

- APT(Advanced Persistent Threat)
    - 지능형 지속 공격.
    - 일정한 절차나 특정 기술을 계속 반복해서 사용하는 공격이 아니라, 계속 신규로 개발되는 새로운 전술과 기술을 이용하여 다양하게 진화하는 공격
    - DDoS와 같이 단시간 내에 이루어지는 공격이 아닌 짧게는 수일에서 길게는 수년 단위로 공격이 지속되는 공격 유형.
    
    [APT-1 (APT 공격이란 무엇인가?)](https://brunch.co.kr/@ka3211/23)
    
- 스피어 피싱(Spear Phishing)
    - 불특정 다수가 아닌 특정인의 정보를 캐내기 위한 피싱 공격
        
        ![Untitled](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/fb300a39-9d86-462b-8502-f290eee20052)
        
        [[보안동향] 스피어피싱(Spear-Phishing) 정의와 그 해결법](https://m.blog.naver.com/skinfosec2000/220591191289)
        

Kimsuky 그룹은 일반적으로 초기 침투 경로로써 스피어 피싱 공격을 주로 사용한다. 최근에는 LNK 포맷의 바로가기 악성코드들을 이용한 공격사례들이 차지하는 비중이 높아지고 있지만,  JavaScript 악성코드나 악성 문서 파일을 이용하는 공격 사례도 지속적으로 확인된다.

JavaScript 악성코드를 이용하는 공격 사례는 **AppleSeed** 악성코드 유포에 주로 사용되는데, 사용되는 악성코드들의 큰 변화 없이 유사한 방식으로 수년간 지속적으로 사용하고 있다는 점이 특징이다.

이번 리서치에서는 최근 공격 사례에서 사용된 악성코드들의 특징을 분석했다.

### 1. AppleSeed

---

**AppleSeed**는 C&C 서버로부터 전달받은 공격자의 명령을 수행할 수 있는 백도어 악성코드다. 공격자는 AppleSeed를 이용해 감염 시스템을 제어할 수 있으며, 이외에도 추가 악성코드를 설치하는 다운로더 기능과 키 로깅 및 스크린 캡처, 그리고 사용자 시스템의 파일들을 수집하여 전송하는 정보 탈취 기능들을 지원한다.

- C&C(Command & Control) 서버
    - 감염된 좀비 PC가 해커가 원하는 공격을 수행하도록 원격지에서 명령을 내리거나, 악성코드를 제어하는 서버
    - 감염된 PC로 악성코드 유포, 스팸 전송, DDoS 공격 전달 등 …
    

과거 공격사례들과 동일하게 JavaScript 드로퍼 악성코드를 이용한 유포 방식이 자주 사용된다.  JavaScript 드로퍼 악성코드는 AppleSeed를 설치하면서 동시에 HWP, PDF와 같은 문서 파일을 생성해 보여주는 기능을 담당하는데, 이런 점 때문에 일반 사용자들은 정상적으로 문서 파일을 실행한 것으로 착각할 수 있다.

![AppleSeed를 드롭하는JavaScript](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/ab5333d6-0837-40d1-b1af-7c3f03e95e8d)

AppleSeed를 드롭하는JavaScript

![미끼 문서 내용 중 일부, 외교부 관련 종사자 대상 공격으로 추정됨.](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/6b03a6dd-cad8-45e2-8433-0d33821fd15d)

미끼 문서 내용 중 일부, 외교부 관련 종사자 대상 공격으로 추정됨.

설치되는 AppleSeed 악성코드 자체는 과거와 유사하지만, 2022년 초부터 JavaScript 악성코드가 직접 AppleSeed를 설치하는 대신, 드로퍼를 거쳐 AppleSeed를 생성하는 방식으로 변경되었다. 단순히 드로퍼만 설치 과정에서 추가된 것이 아니라, 악성코드 실행 시 분석을 방해하기 위해 인자를 검사하는 기능이 추가된 것이 특징이다.

- AppleSeed 실행 인자 예시:
    
    `regsvr32.exe /s /n /i:1qa2ws4rf “C:\Users{UserName}\AppData\Roaming\FoxitReader\Service\FoxitReaderUpdate.db”`
    
- AppleSeed 설치 시 사용되는 인자
    
    
    | 기간 | 인자 목록 |
    | --- | --- |
    | 과거 | 123qweasdzxc
    123qweASDTYU
    12345QWERTY
    1q2w3e4r!
    2wsx!QAZ3edc
    $%ERT345ert |
    | 최근 | 12qw3ed
    1qa2ws4rf |

### 2. AlphaSeed

---

또한, AppleSeed의 변종 악성코드인 **AlphaSeed**도 존재한다. AppleSeed와 비교하면 대부분 기능이 유사하며, 차이점은 AlphaSeed의 경우 Golang으로 개발되었고 ChromeDP를 이용해 C&C 통신을 한다는 점이다. (AppleSeed는 주로 HTTP 프로토콜이나 이메일 즉 SMTP, IMAPS 프로토콜을 이용한다)

AlphaSeed는 C&C 통신에서 직접 메일을 발송하는 대신 ChromeDP 도구를 이용한다. 직접 ID/PW를 이용하는 대신 특정 계정으로 로그인하는 데 필요한 쿠키 값을 이용해 로그인 하는 것이 특징이다.

![로그인에 필요한 쿠키 값](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/c3c50613-22ad-47d4-a2a3-8c7fb810497c)

로그인에 필요한 쿠키 값

AppleSeed와 동일하게 공격에 JavaScript 드로퍼 악성코드가 사용되며, 설치과정도 유사하다. 동일한 대상에 대해 AlphaSeed와 AppleSeed를 함께 설치하기도 하는데, 다음 사례가 그렇다.

![Untitled](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/57aca419-4f23-4ff1-8d85-68d0020d9f02)

### 3. 결론

---

Kimsuky 그룹은 특히 국내 사용자들을 대상으로 지속적으로 스피어 피싱 공격을 수행하고 있다. 주로 메일의 첨부 파일로써 문서 파일을 위장한 악성코드를 유포하는 방식이며, 이를 실행하면 현재 사용 중인 시스템에 대한 제어가 탈취될 수 있다. 앞에서 살펴본 AppleSeed와 AlphaSeed 외에도 Metasploit에서 제공하는 악성코드인 Meterpreter나 VNC 악성코드를 사용하고 있다.

Kimsuky 그룹의 사이버 공격 활동은 미국 정부가 북한 정부를 대상으로 제재를 가한 이후부터 더욱 증가하고 있다. 사용자는 메일의 발신자를 상세하게 확인해야 하며, 출처가 불분명한 파일의 경우 열람을 자제해야 한다. 또한 OS 및 인터넷 브라우저 등의 프로그램들에 대한 최신 패치 및 백신 프로그램을을 최신 버전으로 업데이트하여 이러한 악성코드의 감염을 사전에 차단할 수 있도록 신경써야 한다.

### 참고

---

[Kimsuky 그룹의 AppleSeed 악성코드 공격 동향 분석 - ASEC BLOG](https://asec.ahnlab.com/ko/59933/)

[북한 APT 공격그룹 킴수키 그룹이 최근 사이버 공격에 사용하는 무기들](https://www.dailysecu.com/news/articleView.html?idxno=152521)

[AhnLab | 콘텐츠 센터](https://m.ahnlab.com/ko/contents/content-center/31442)