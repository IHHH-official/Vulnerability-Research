# Cisco IOS XE Software Web UI ì·¨ì•½ì 

### Author

---

ê¹€ìˆœìš±

### Date

---

2023.10.16

### Summary

---

**Cisco** ë¼ìš°í„° ë° ì¼ë¶€ ìŠ¤ìœ„ì¹˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” ìš´ì˜ì²´ì œì¸ **IOS XE ì†Œí”„íŠ¸ì›¨ì–´**ë“¤ì—ì„œ ê¶Œí•œì´ ì—†ëŠ” ì‚¬ìš©ìê°€ ì›¹ ê´€ë¦¬ì ê¶Œí•œ ë¿ ì•„ë‹ˆë¼ ê¸°ê¸°ì˜ root ê¶Œí•œê¹Œì§€ íƒˆì·¨í•  ìˆ˜ ìˆëŠ” í¬ë¦¬í‹°ì»¬í•œ ì·¨ì•½ì ë“¤(`CVE-2023-20198`, `CVE-2023-20273`)ì´ ë°œê²¬ë˜ì—ˆë‹¤.

### Keywords

---

#CVE-2023-20198 #CVE-2023-20273 #Cisco #IOS_XE_software #Web_UI #Privllege_Escalation_Vulnerability #CSCwh87343

### Root Cause

---

`CVE-2023-20198` ì·¨ì•½ì ì€ ì¸ì¦ë˜ì§€ ì•Šì€ ê³µê²©ìê°€ ê°€ì¥ ë†’ì€ ìˆ˜ì¤€ì˜ ì ‘ê·¼ ê¶Œí•œì¸ ë ˆë²¨ 15 ê¶Œí•œì˜ ì„ì˜ì˜ ê³„ì •ì„ ìƒì„±í•˜ì—¬ ì‹œìŠ¤í…œì„ ì œì–´í•  ìˆ˜ ìˆìœ¼ë©°, `CVE-2023-20273` ì·¨ì•½ì ì€ ëª…ë ¹ì–´ ì£¼ì…ì„ ìˆ˜í–‰í•˜ì—¬ ì•…ì˜ì ì¸ ë‚´ìš©ì„ íŒŒì¼ ì‹œìŠ¤í…œì— ì“¸ ìˆ˜ ìˆë‹¤. ê°ê° CVSS ì ìˆ˜ **10.0**ê³¼ **7.2**ë¥¼ í• ë‹¹ë°›ì•˜ë‹¤.

![POC](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/3fe5c0f0-1899-414e-90fd-aef358ba981b)

POC

POC ì½”ë“œëŠ” ìœ„ì™€ ê°™ë‹¤. baduserë¼ëŠ” ì´ë¦„ì˜ ë ˆë²¨ 15 ê¶Œí•œì˜ ìœ ì €ë¥¼ ìƒì„±í•œë‹¤.

ì´ ì½”ë“œì—ì„œ í•µì‹¬ì€ ë°”ë¡œ ì²«ì¤„(`POST /%2577ebui_wsma_HTTP`)ì´ë‹¤. ì´ëŠ” ë°”ë¡œ `webui_wsma_http`ë¥¼ ì•”í˜¸í™”í•œ ê²ƒìœ¼ë¡œ, ì´ë¥¼ í†µí•´ Nginx ì¼ì¹˜ë¥¼ ìš°íšŒí•˜ê³  WSMA ì„œë¹„ìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

WSMA(Web Services Management Agent) ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³  SOAP ìš”ì²­ì„ í†µí•´ ì‹œìŠ¤í…œì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ ë‹¤ìŒì˜ CLI ëª…ë ¹ì„ ë³´ë‚´ 15ë ˆë²¨ ê¶Œí•œì˜ ìƒˆ ìœ ì €ë¥¼ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

> username <user> privilege 15 secret <password>
> 

![ìƒˆ ìœ ì €ì¸ baduserë¥¼ ìƒì„±í•œ ëª¨ìŠµ](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/bfc55e8b-80b3-4610-b79e-db42a311e0b1)

ìƒˆ ìœ ì €ì¸ baduserë¥¼ ìƒì„±í•œ ëª¨ìŠµ

POCë¥¼ ì‹¤í–‰í•œ í›„, UIì—ì„œ Administration â†’ User Administrationì—ì„œ ìƒì„±í•œ ìƒˆ ìœ ì €ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![íŒ¨ì¹˜ëœ ì½”ë“œ](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/8329efc3-61f3-4d21-a982-76f446a2136e)

íŒ¨ì¹˜ëœ ì½”ë“œ

Ciscoì—ì„œ í•´ë‹¹ ì·¨ì•½ì ì„ í™•ì¸í•˜ê³  ì´ë¥¼ íŒ¨ì¹˜í•´ ë°°í¬í•œ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´, íŒ¨ì¹˜ëœ `Proxy-Uri-Source` í—¤ë”ëŠ” ê¸°ë³¸ í—¤ë”ê°’(`webui_internal`)ì„ ì„¤ì •í•˜ì—¬ ìœ„ì™€ ê°™ì€ ê³µê²©ìì˜ ì•¡ì„¸ìŠ¤ë¥¼ ë°©ì§€í•œë‹¤.

Cisco IOS XE Softwareì˜ Web UI ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ” ëª¨ë“  ì¥ë¹„ë“¤ì´ ì´ ì·¨ì•½ì ë“¤ì˜ ì˜í–¥ì„ ë°›ëŠ”ë‹¤. ì˜ˆì‹œì²˜ëŸ¼ ë‹¤ìŒ ëª…ë ¹ì–´ë“¤ì— ëŒ€í•œ ê²°ê³¼ê°€ í•˜ë‚˜ ì´ìƒ ë‚˜íƒ€ë‚œë‹¤ë©´, Web UI ê¸°ëŠ¥ì´ í™œì„±í™” ë˜ì–´ìˆë‹¤ê³   íŒë‹¨í•  ìˆ˜ ìˆë‹¤.

> Router# **show running-config | include ip http server|secure|active**
> 
> 
> ip http server
> 
> ip http secure-server
> 

### Exploit

---

`CVE-2023-20198` ì·¨ì•½ì  ê³µê²©ì„ ì„±ê³µí•˜ë©´, ê³µê²©ìëŠ” ì „ì²´ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì¥ì¹˜ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤. ë””ë°”ì´ìŠ¤ë¥¼ ì†ìƒì‹œí‚¨ í›„ ê³µê²©ìëŠ” ë˜ë‹¤ë¥¸ ì·¨ì•½ì ì¸ `CVE-2023-20273`ì„ ì´ìš©í•œë‹¤. ì´ë¥¼ í†µí•´ ê³µê²©ìëŠ” ìƒìŠ¹ëœ ê¶Œí•œìœ¼ë¡œ ëª…ë ¹ì–´ ì£¼ì…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ë˜ëŠ”ë°, ì´ë•Œ íŒŒì¼ ì‹œìŠ¤í…œì— **BadCandy** ì„í”Œë€íŠ¸ë¥¼ ì“¸ ìˆ˜ ìˆë‹¤.

BadCandyëŠ” Lua í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ê¸°ë°˜ìœ¼ë¡œ, ì„ì˜ì˜ ëª…ë ¹ ì‹¤í–‰ì„ ìš©ì´í•˜ê²Œ í•˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ 29ì¤„ì˜ ì½”ë“œë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤.

![BadCandy ì½”ë“œ](https://github.com/IHHH-official/Vulnerability-Research/assets/48719589/68217f62-136f-4803-bbaf-752bc59eb8e4)

BadCandy ì½”ë“œ

ê³µê²©ìëŠ” ì¥ì¹˜ì— HTTP POST ìš”ì²­ì„ ìƒì„±í•˜ê³ , ë‹¤ìŒì˜ ì„¸ê°€ì§€ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

1. ì²« ë²ˆì§¸ ê¸°ëŠ¥ì€ â€œ`menu`â€ ë§¤ê°œë³€ìˆ˜ì— ì˜í•´ ì§€ì‹œë˜ëŠ”ë°, â€œ/â€ë¡œ ë‘˜ëŸ¬ì‹¸ì¸ ì¼ë ¨ì˜ ìˆ«ìë¥¼ ë°˜í™˜í•˜ë©°, ì„í”Œë€íŠ¸ ë²„ì „ì„ ë‚˜íƒ€ë‚´ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.
2. ë‘ ë²ˆì§¸ ê¸°ëŠ¥ì€ â€œ`logon_hash`â€ ë§¤ê°œ ë³€ìˆ˜ì— ì˜í•´ ì§€ì‹œë˜ë©°, ì´ ë§¤ê°œ ë³€ìˆ˜ëŠ” â€œ1â€ë¡œ ì„¤ì •ë˜ì–´ì•¼ í•œë‹¤. ê·¸ëŸ¬ë©´ ì„í”Œë€íŠ¸ì— í•˜ë“œ ì½”ë”©ëœ 18ì 16ì§„ìˆ˜ ë¬¸ìì—´ì´ ë°˜í™˜ëœë‹¤.
3. ì„¸ ë²ˆì§¸ ê¸°ëŠ¥ë„ â€œ`logon_hash`â€ì™€ â€œ`common_type`â€ ë§¤ê°œ ë³€ìˆ˜ì— ì˜í•´ ì§€ì‹œëœë‹¤. â€œ`logon_hash`â€ëŠ” ì„í”Œë€íŠ¸ì— í•˜ë“œ ì½”ë”©ëœ 40ì 16ì§„ìˆ˜ ë¬¸ìì—´ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê³ , â€œ`common_type`â€ ë§¤ê°œë³€ìˆ˜ëŠ” ì½”ë“œê°€ ì‹œìŠ¤í…œ ë ˆë²¨(â€`subsystem`â€)ì—ì„œ ì‹¤í–‰ë˜ëŠ”ì§€, IOS ë ˆë²¨(â€`iox`â€)ì—ì„œ ì‹¤í–‰ë˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ê²°ì •í•œë‹¤.

ìœ„ ì½”ë“œ ì™¸ì—ë„ í•µì‹¬ ê¸°ëŠ¥ì€ ë™ì¼í•˜ê²Œ ìœ ì§€í•œ ì±„ í—¤ë”ì— ëŒ€í•œ ê²€ì‚¬ë¥¼ í¬í•¨í•œ BadCandyì˜ ë‹¤ë¥¸ ë²„ì „ë“¤ì„ ì´ìš©í•˜ëŠ” ì‚¬ë¡€ë“¤ë„ í™•ì¸ë˜ì—ˆë‹¤ê³  í•œë‹¤.

### Solution

---

í•´ë‹¹ ì·¨ì•½ì  ë°œê²¬ ì§í›„ì—ëŠ” íŒ¨ì¹˜ê°€ ê³µê°œë˜ì§€ ì•Šì•„ ìš°ì„  ë‹¤ìŒ ì˜ì‚¬ê²°ì • íŠ¸ë¦¬ì— ë”°ë¥´ë„ë¡ ê¶Œê³ í–ˆë‹¤.

> Q. IOS XEë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?
> 
> - ì•„ë‹ˆì˜¤ â†’ ì¡°ì¹˜ê°€ í•„ìš”ì—†ìŒ
> - ë„¤
> 
> Q. `ip http server` ë˜ëŠ” `ip http secure-server`ê°€ êµ¬ì„±ë˜ì–´ ìˆëŠ”ê°€?
> 
> - ì•„ë‹ˆì˜¤ â†’ ì·¨ì•½ì„±ì„ ì•…ìš©í•  ìˆ˜ ì—†ìŒ, ì¡°ì¹˜ í•„ìš”ì—†ìŒ
> - ë„¤
> 
> Q. HTTP/HTTPS í†µì‹ ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤(ex. eWLC)ë¥¼ ìš´ì˜í•˜ëŠ”ê°€?
> 
> - ì•„ë‹ˆì˜¤ â†’ HTTP ì„œë²„ ê¸°ëŠ¥ ë¹„í™œì„±í™”
>     - HTTP ì„œë²„ ì‚¬ìš© ì‹œ: `no ip http server`
>     - HTTPS ì„œë²„ ì‚¬ìš© ì‹œ: `no ip http secure-server`
> - ë„¤ â†’ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì›Œí¬ë¡œ ì œí•œ

ë˜í•œ, ì„œë²„ ì¬ì‹œì‘ ì‹œ ë˜ë‹¤ë¥¸ ë©€ì›¨ì–´ê°€ ì‹¤í–‰ë˜ê±°ë‚˜ ì¹¨í•´ ì§€í‘œ(IOC)ê°€ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆì–´ ì¬ì‹œì‘ë³´ë‹¤ëŠ” ë‹¤ë¥¸ ì„œë²„ì™€ì˜ ê²©ë¦¬ë¥¼ ê¶Œê³ í–ˆë‹¤.

í˜„ì¬ëŠ” Ciscoì—ì„œ ë°°í¬í•œ ìµœì‹  ë³´ì•ˆ íŒ¨ì¹˜(Bug ID: CSCwh87343)ë¥¼ ë°›ì•„ í•´ê²° í•  ìˆ˜ ìˆë‹¤.

### Reference

---

[Cisco IOS XE Software Web UI ì·¨ì•½ì  ì£¼ì˜ (CVE-2023-20198, CVE-2023-20273) - ASEC BLOG](https://asec.ahnlab.com/ko/57951/)

[2023 HotğŸ”¥ ë³´ì•ˆ ì‚¬ê±´ ì‚¬ê³ â€Šâ€”â€Ší•˜ë°˜ê¸°](https://blog.theori.io/2023-h2-hot-security-issue-case-ec54369d1886)

[Cisco Security Advisory: Multiple Vulnerabilities in Cisco IOS XE Software Web UI Feature](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-iosxe-webui-privesc-j22SaA4z)

[Software Fix Availability for Cisco IOS XE Software Web UI Privilege Escalation Vulnerability - CVE-2023-20198](https://www.cisco.com/c/en/us/support/docs/ios-nx-os-software/ios-xe-dublin-17121/221128-software-fix-availability-for-cisco-ios.html)

[Active exploitation of Cisco IOS XE Software Web Management User Interface vulnerabilities](https://blog.talosintelligence.com/active-exploitation-of-cisco-ios-xe-software/)